name: PMbootstrap Build for Xiaomi Gemini
on: [push]
jobs:
  build:
    runs-on: ubuntu-22.04
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Install full system dependencies
        run: |
          sudo apt update
          sudo apt install -y python3 python3-pip python3-venv git sudo

      - name: Create venv and install pmbootstrap
        run: |
          python3 -m venv pmb-venv
          source pmb-venv/bin/activate
          pip install pmbootstrap==3.6.0
          echo "source /data/data/com.termux/files/home/pmos-xiaomi-gemini-build/pmb-venv/bin/activate" >> 

      - name: Initialize pmbootstrap
        run: |
          pmbootstrap --version
          pmbootstrap init <<EOF
          gemini
          postmarketOS Edge
          mainline
          none
          ext4
          4
          EOF

      - name: Build the image
        run: pmbootstrap build
